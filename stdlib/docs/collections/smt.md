
## std::collections::smt
| Procedure | Description |
| ----------- | ------------- |
| memcopy_word_range_and_advance_ptrs | Copies from the memory range starting at `read_start_ptr` and ending at `read_end_ptr`, to<br />memory starting at `write_ptr`, and returns updated pointers, advanced by how much data was<br />copied.<br /><br />Unlike mem::memcopy_words, this procedure takes a start and end pointer, and does not copy<br />anything if `end - start < 1`.<br /><br />Inputs: [read_start_ptr, read_end_ptr, write_ptr]<br />Outputs: [read_ptr', write_ptr']<br /><br />Where:<br />- `read_ptr'` is `read_start_ptr` plus the count of elements that were copied.<br />- `write_ptr'` is `write_ptr` plus the count of elements that were copied.<br /> |
| hash_and_insert_mem | Hashes an array of SMT leaves, then updates both the advice map and Merkle store.<br /><br />Returns the node value (hash) of the previous leaf at the given index, as well as<br />the root for the new SMT.<br /><br />Inputs: [start_addr, end_addr, leaf_index, R]<br />Outputs: [NV_old, R_new]<br /> |
| insert_single_to_multi_leaf | Inserts a key-value pair into a leaf currently containing a single, non-empty pair,<br />converting the leaf to a multi-leaf.<br /><br />Inputs: [K_in_leaf, K, V_in_leaf, V, R]<br />Outputs: [V_in_leaf, R_new]<br /> |
| set_empty_leaf | Inserts or removes a value associated with the given key. The leaf to which we're inserting is<br />guaranteed to be empty.<br /><br />Inputs:<br />Operand stack: [V, K, R, ...]<br /><br />Outputs:<br />Operand stack: [V_old, R_new, ...]<br /><br />Cycles<br />Insert empty value: X cycles<br />Insert non-empty value: X cycles<br /> |
| insert_single_leaf | Inserts a value at the given key. The leaf to which we're inserting is<br />guaranteed to hold a single key-value pair (provided on the advice stack).<br /><br />If `K != K_in_leaf`<br /><br />Inputs:<br />Operand stack: [V, K, R, ...]<br />Advice stack:  [K_in_leaf, V_in_leaf]<br /><br />Outputs:<br />Operand stack: [V_old, R_new, ...]<br /><br />Cycles:<br />Leaf single after insertion: X cycles<br />Leaf multiple after insertion: unimplemented<br /> |
| remove_single_leaf | Removes the provided key/value pair from the leaf. The leaf to which we're inserting is<br />guaranteed to hold a single key-value pair (provided on the advice stack). Hence, after the<br />operation, the leaf will be empty.<br /><br />Inputs:<br />Operand stack: [V (=ZERO), K, R, ...]<br />Advice stack:  [K_in_leaf, V_in_leaf]<br /><br />Outputs:<br />Operand stack: [V_old, R_new, ...]<br /><br />Cycles: X<br /> |
| set_single_leaf | Inserts or removes a value associated with the given key. The leaf to which we're inserting is<br />guaranteed to hold a single key-value pair (provided on the advice stack).<br /><br />Inputs:<br />Operand stack: [V, K, R, ...]<br />Advice stack:  [K_in_leaf, V_in_leaf]<br /><br />Outputs:<br />Operand stack: [V_old, R_new, ...]<br />Cycles:<br />Remove: X cycles<br />Insert; leaf single after insertion: X cycles<br />Insert; leaf multiple after insertion: unimplemented<br /> |
| set | Inserts the specified value under the specified key in a Sparse Merkle Tree defined by the<br />specified root. If the insert is successful, the old value located under the specified key<br />is returned via the stack.<br /><br />If the VALUE is an empty word (i.e., [ZERO; 4]), the new state of the tree is guaranteed to<br />be equivalent to the state as if the updated value was never inserted.<br /><br />Inputs:<br />Operand stack: [V, K, R, ...]<br />Outputs:<br />Operand stack: [V_old, R_new, ...]<br /><br />Fails if the tree with the specified root does not exits in the VM's advice provider.<br /><br />Cycles<br />Leaf empty<br />removal: 74 cycles<br />insertion: 133 cycles<br />Leaf single<br />removal: 227 cycles<br />insertion (leaf remains single): 205<br />insertion (leaf becomes multiple): unimplemented<br />Leaf multiple<br />unimplemented<br /> |
| get_multi_leaf_value | Gets a value at the given key.<br /><br />The leaf we're retrieving from is guaranteed to hold more than one key-value<br />pair (provided on the advice stack).<br /><br />Inputs:<br />Operand stack: [leaf_size, NV, K, R]<br />Advice stack:  [V1, K2, V2, K2, ...]<br /><br />Outputs:<br />Operand stack: [V, R]<br /><br />Cycles:<br />Non-empty: 125 + 3 * pair_count<br />Empty: 122 + 3 * pair_count<br /> |
| get | Returns the value located under the specified key in the Sparse Merkle Tree defined by the<br />specified root.<br /><br />If no values had been previously inserted under the specified key, an empty word (i.e.,<br />[ZERO; 4]) is returned.<br /><br />Inputs:<br />Operand stack: [K, R, ...]<br /><br />Outputs:<br />Operand stack: [V, R, ...]<br /><br />Fails if the tree with the specified root does not exits in the VM's advice provider.<br /><br />Cycles<br />Leaf empty: 66 cycles<br />Leaf single: 115 cycles<br />Leaf multiple, non-empty value: 189 + 3 * pair_count<br />Leaf multiple, empty value: 186 + 3 * pair_count<br /> |
